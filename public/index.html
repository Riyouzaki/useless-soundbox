<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Useless Sound Box</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <link rel="stylesheet" href="styles/font-awesome.min.css">
    <link rel="stylesheet" href="styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png" />
    <link rel="icon" type="image/png" href="images/favicon.png" />

    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-107262369-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments)};
      gtag('js', new Date());

      gtag('config', 'UA-107262369-1');
    </script>
  </head>
  <body>
    <div class="page-header">
      <h1><span>Useless</span></br>Sound Box</h1>
    </div>
    <audio id="philippe" onended="onEnded('philippe')">
      <source src="sounds/philippe.mp3" type="audio/mpeg" />
    </audio>
    <audio id="motus" onended="onEnded('motus')">
      <source src="sounds/motus.mp3" type="audio/mpeg" />
    </audio>
    <audio id="jeanne" onended="onEnded('jeanne')">
      <source src="sounds/jeanne.mp3" type="audio/mpeg" />
    </audio>
    <audio id="rouquin" onended="onEnded('rouquin')">
      <source src="sounds/rouquin.mp3" type="audio/mpeg" />
    </audio>
    <audio id="ah" onended="onEnded('ah')">
      <source src="sounds/ah.mp3" type="audio/mpeg" />
    </audio>
    <audio id="baptiste" onended="onEnded('baptiste')">
      <source src="sounds/baptiste.mp3" type="audio/mpeg" />
    </audio>
    <audio id="cafard" onended="onEnded('cafard')">
      <source src="sounds/cafard.mp3" type="audio/mpeg" />
    </audio>
    <audio id="souffrir" onended="onEnded('souffrir')">
      <source src="sounds/souffrir.mp3" type="audio/mpeg" />
    </audio>
    <audio id="universal" onended="onEnded('universal')">
      <source src="sounds/universal.mp3" type="audio/mpeg" />
    </audio>
    <audio id="centuryfox" onended="onEnded('centuryfox')">
      <source src="sounds/centuryfox.mp3" type="audio/mpeg" />
    </audio>
    <audio id="jonathan" onended="onEnded('jonathan')">
      <source src="sounds/jonathan.mp3" type="audio/mpeg" />
    </audio>

    <div class="useless-sound-wrapper">
      <div class="container">
        <div class="row">
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-philippe" type="button" class="btn btn-player" onclick="launchSound('philippe')">
                <i id="icon-play-philippe" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-philippe" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/philippe.jpg" alt="PHILIPPE"/>
                <p>PHILIPPE</p>
              </button>
            </div>
          </div>
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-motus" type="button" class="btn btn-player" onclick="launchSound('motus')">
                <i id="icon-play-motus" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-motus" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/motus.jpg" alt="MOTUS"/>
                <p>MOTUS</p>
              </button>
            </div>
          </div>
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-jeanne" type="button" class="btn btn-player" onclick="launchSound('jeanne')">
                <i id="icon-play-jeanne" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-jeanne" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/jeanne.jpg" alt="JEANNE"/>
                <p>JEANNE</p>
              </button>
            </div>
          </div>
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-rouquin" type="button" class="btn btn-player" onclick="launchSound('rouquin')">
                <i id="icon-play-rouquin" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-rouquin" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/rouquin.jpg" alt="ROUQUIN"/>
                <p>ROUQUIN</p>
              </button>
            </div>
          </div>
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-ah" type="button" class="btn btn-player" onclick="launchSound('ah')">
                <i id="icon-play-ah" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-ah" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/ah.jpg" alt="AH"/>
                <p>AH</p>
              </button>
            </div>
          </div>
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-souffrir" type="button" class="btn btn-player" onclick="launchSound('souffrir')">
                <i id="icon-play-souffrir" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-souffrir" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/souffrir.jpg" alt="SOUFFRIR"/>
                <p>SOUFFRIR</p>
              </button>
            </div>
          </div>
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-cafard" type="button" class="btn btn-player" onclick="launchSound('cafard')">
                <i id="icon-play-cafard" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-cafard" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/cafard.jpg" alt="CAFARD"/>
                <p>CAFARD</p>
              </button>
            </div>
          </div>
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-universal" type="button" class="btn btn-player" onclick="launchSound('universal')">
                <i id="icon-play-universal" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-universal" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/universal.jpg" alt="UNIVERSAL"/>
                <p>UNIVERSAL</p>
              </button>
            </div>
          </div>
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-baptiste" type="button" class="btn btn-player" onclick="launchSound('baptiste')">
                <i id="icon-play-baptiste" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-baptiste" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/baptiste.jpg" alt="BAPTISTE"/>
                <p>BAPTISTE</p>
              </button>
            </div>
          </div>
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-centuryfox" type="button" class="btn btn-player" onclick="launchSound('centuryfox')">
                <i id="icon-play-centuryfox" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-centuryfox" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/centuryfox.jpg" alt="CENTURYFOX"/>
                <p>CENTURYFOX</p>
              </button>
            </div>
          </div>
          <div class="col-3">
            <div class="btn-container">
              <button id="btn-play-jonathan" type="button" class="btn btn-player" onclick="launchSound('jonathan')">
                <i id="icon-play-jonathan" class="fa fa-play" aria-hidden="true"></i>
                <i id="icon-playing-jonathan" class="fa fa-music" style="display: none;" aria-hidden="true"></i>
                <img src="images/jonathan.jpg" alt="JONATHAN"/>
                <p>JONATHAN</p>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      var playing = false
      var playingId = null

      var onEnded = function(id) {
        console.log('Sound ended: ' + id)
        document.getElementById('btn-play-' + id).className = 'btn btn-player';
        document.getElementById('icon-playing-' + id).style.display = 'none';
        document.getElementById('icon-play-' + id).style.display = 'inline';
        playing = false
      }

      var trackSound = function(id) {
        fetch('/api/track/play_sound/' + id, {method: 'POST'})
        .then(response => console.log(id + ' tracked!'))
        .catch(error => console.error(error))
      }

      launchSound = function(id) {
        var audio = document.getElementById(id)
        if (audio) {
          if (playing) {
            console.log('Another sound is playing: ' + playingId)
            var playingAudio = document.getElementById(playingId)
            document.getElementById('btn-play-' + playingId).className = 'btn btn-player';
            document.getElementById('icon-playing-' + playingId).style.display = 'none';
            document.getElementById('icon-play-' + playingId).style.display = 'inline';
            playingAudio.pause()
            playingAudio.currentTime = 0;
            if (id !== playingId) {
              playingId = id
              document.getElementById('btn-play-' + id).className = 'btn btn-player btn-active';
              document.getElementById('icon-play-' + id).style.display = 'none';
              document.getElementById('icon-playing-' + id).style.display = 'inline';
              audio.play()
              trackSound(id)
            } else {
              playing = false
            }
          } else {
            console.log('Playing sound: ' + id)
            playing = true
            playingId = id
            document.getElementById('btn-play-' + id).className = 'btn btn-player btn-active';
            document.getElementById('icon-play-' + id).style.display = 'none';
            document.getElementById('icon-playing-' + id).style.display = 'inline';
            trackSound(id)
            audio.play()
          }
        }
      }
    </script>
  </body>
</html>
